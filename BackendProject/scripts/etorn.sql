
CREATE TABLE STORE (
  ID INTEGER PRIMARY KEY AUTO_INCREMENT,
  NAME VARCHAR(30) NOT NULL,
  DATE_CREATED DATETIME  NOT NULL
);

CREATE TABLE QUEUE (
  ID INTEGER PRIMARY KEY AUTO_INCREMENT,
  ID_STORE INTEGER NOT NULL,
  QUEUE_TYPE VARCHAR(10) NOT NULL,
  PRIORITY INTEGER(1) NOT NULL
);

CREATE TABLE BUCKET (
  ID INTEGER PRIMARY KEY AUTO_INCREMENT,
  ID_QUEUE INTEGER NOT NULL,
  HOUR_FINAL DATETIME NOT NULL,
  QUANTITY INTEGER(1) NOT NULL
);

CREATE TABLE TURN (
  ID INTEGER PRIMARY KEY AUTO_INCREMENT,
  NUMBER INTEGER NOT NULL,
  ID_BUCKET INTEGER,
  ID_USER INTEGER,
  ID_QUEUE INTEGER,
  DATE_TURN DATETIME NOT NULL,
  STATE VARCHAR(10) NOT NULL
);

ALTER TABLE QUEUE ADD FOREIGN KEY (ID_STORE) REFERENCES STORE(ID);
ALTER TABLE BUCKET ADD FOREIGN KEY (ID_QUEUE) REFERENCES QUEUE(ID);

ALTER TABLE TURN ADD FOREIGN KEY (ID_BUCKET) REFERENCES BUCKET(ID);
ALTER TABLE TURN ADD FOREIGN KEY (ID_QUEUE) REFERENCES QUEUE(ID);

INSERT INTO STORE (NAME, DATE_CREATED) VALUES ('Carnisseria', NOW());
INSERT INTO STORE (NAME, DATE_CREATED) VALUES ('Peixateria', NOW());
INSERT INTO STORE (NAME, DATE_CREATED) VALUES ('Sushi', NOW());
INSERT INTO STORE (NAME, DATE_CREATED) VALUES ('Xarcuteria', NOW());
INSERT INTO STORE (NAME, DATE_CREATED) VALUES ('Forn de pa', NOW());

INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (1, 'VIP', 0);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (1, 'MOBILES', 1);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (1, 'TOTEM', 2);

INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (2, 'VIP', 0);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (2, 'MOBILES', 1);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (2, 'TOTEM', 2);

INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (3, 'VIP', 0);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (3, 'MOBILES', 1);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (3, 'TOTEM', 2);

INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (4, 'VIP', 0);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (4, 'MOBILES', 1);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (4, 'TOTEM', 2);

INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (5, 'VIP', 0);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (5, 'MOBILES', 1);
INSERT INTO QUEUE (ID_STORE, QUEUE_TYPE, PRIORITY) VALUES (5, 'TOTEM', 2);